import{r as d,j as e,c as Ke,W as ut,b as F,z as Qe,aa as mt,as as pt,am as Je,an as Te}from"./index-CA7vLNFI.js";import{I as K,F as ft,a as ht,b as gt,c as O,d as W,e as Le}from"./formik.esm-BtFMNxVz.js";import{B as me}from"./Button-BWlffnBS.js";import{c as Me,a as le,e as Ce,d as Ye,f as Ie,g as xe}from"./index.esm-Ca3ujU5O.js";import{t as Ve,N as $e}from"./toast-DD4ocoaX.js";import{A as ke}from"./AdaptableCard-CmhLWxHq.js";import{a7 as yt,a8 as Dt,a9 as Re,aa as Ue}from"./toString-C_n6VLVY.js";import{u as _e}from"./useControllableState-CUoXx6vD.js";import{a as bt,c as xt,h as jt,d as Ct,e as kt,g as wt,i as vt,u as ye,o as Nt,f as Mt,s as St}from"./floating-ui.react-3izAV1IH.js";import{c as se,C as nt,a as At,i as Ze}from"./Calendar-CoU5m-QP.js";import{C as st}from"./get-BX0NKbV_.js";import{c as Ft}from"./Views-DLdkzVCz.js";import{u as Pt}from"./useUniqueId-CHCEdNH2.js";import"./isNil-C6Hksnuv.js";import"./index-B5bUWmwT.js";import"./StatusIcon-B6CLEAZ-.js";import"./Card-DAnh9Ik9.js";const qt=c=>{const{children:g,className:y,stickyClass:f,...l}=c,[D,k]=d.useState(!1),b=d.useRef(null);return d.useEffect(()=>{const o=b.current,m=new IntersectionObserver(([s])=>k(s.intersectionRatio<1),{threshold:[1]});return m.observe(o),function(){m.unobserve(o)}},[]),e.jsx("div",{ref:b,className:Ke("sticky -bottom-1",y,D&&f),...l,children:g})};var Se={exports:{}},Et=Se.exports,Ge;function Ot(){return Ge||(Ge=1,function(c,g){(function(y,f){c.exports=f()})(Et,function(){var y={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(f,l,D){var k=l.prototype,b=k.format;D.en.formats=y,k.format=function(o){o===void 0&&(o="YYYY-MM-DDTHH:mm:ssZ");var m=this.$locale().formats,s=function(n,a){return n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(Y,u,j){var M=j&&j.toUpperCase();return u||a[j]||y[j]||a[M].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(r,h,p){return h||p.slice(1)})})}(o,m===void 0?{}:m);return b.call(this,s)}}})}(Se)),Se.exports}var Bt=Ot();const Tt=ut(Bt);F.extend(Tt);const Fe=d.forwardRef((c,g)=>{const{className:y,clearable:f=!0,clearButton:l,children:D,disabled:k,dropdownOpened:b,inputtable:o,inputtableBlurClose:m=!0,inputLabel:s,inputPrefix:n,inputSuffix:a=e.jsx(yt,{className:"text-lg"}),name:Y,onDropdownOpen:u,onDropdownClose:j,onBlur:M,onFocus:r,onChange:h,onKeyDown:p,onClear:t,placeholder:i,setDropdownOpened:C,size:w,type:$,form:G,field:B}=c,S=()=>{o?v():I(!b)},Z=()=>{C(!1),j==null||j()},U=f?l?e.jsx("div",{role:"presentation",onClick:t,children:l}):e.jsx(st,{className:"text-base",onClick:t}):a?e.jsx(e.Fragment,{children:a}):null,I=R=>{C(R),R?u==null||u():j==null||j()},v=()=>{C(!0),u==null||u()},T=R=>{typeof p=="function"&&p(R),(R.key==="Space"||R.key==="Enter")&&!o&&(R.preventDefault(),v())},E=R=>{M==null||M(R),o&&m&&Z()},z=R=>{r==null||r(R)},{refs:Q,floatingStyles:X,context:J}=bt({open:b,onOpenChange:I,placement:"bottom-start",middleware:[Nt(10),Mt({fallbackAxisSideDirection:"start"}),St()],whileElementsMounted:Ft}),L=xt(J),te=jt(J),ce=Ct(J),ie=kt(J),{getReferenceProps:P,getFloatingProps:N}=wt([o?L:te,ce,ie]),V=vt();return e.jsxs(e.Fragment,{children:[e.jsx(K,{ref:ye(g,Q.setReference),form:G,field:B,className:y,placeholder:i,size:w,name:Y,value:s,readOnly:!o,suffix:U,prefix:n,autoComplete:"off",type:$,disabled:k,asElement:"input",onKeyDown:T,onClick:S,onChange:h,...P({onBlur:E,onFocus:z})}),b&&e.jsx("div",{ref:Q.setFloating,className:"picker",style:X,"aria-labelledby":V,...N(),children:e.jsx("div",{className:"picker-panel",children:D})})]})});Fe.displayName="BasePicker";const Xe="YYYY-MM-DD",it=d.forwardRef((c,g)=>{const{className:y,clearable:f=!0,clearButton:l,closePickerOnChange:D=!0,dateViewCount:k,dayClassName:b,dayStyle:o,defaultMonth:m,defaultOpen:s=!1,defaultValue:n,defaultView:a,disabled:Y=!1,disableDate:u,enableHeaderLabel:j,disableOutOfMonth:M,firstDayOfWeek:r="monday",hideOutOfMonthDates:h,hideWeekdays:p,inputFormat:t,inputPrefix:i,inputSuffix:C,inputtable:w,labelFormat:$={month:"MMM",year:"YYYY"},locale:G,maxDate:B,minDate:S,name:Z="date",onBlur:U,onChange:I,onFocus:v,onDropdownClose:T,onDropdownOpen:E,openPickerOnClear:z=!1,renderDay:Q,size:X,style:J,type:L,value:te,weekendDays:ce,yearLabelFormat:ie,...P}=c,{locale:N}=Qe(),V=G||N,R=L==="date"?Xe:t||Xe,[H,re]=d.useState(s),De=d.useRef(null),[be,q]=d.useState(n??null),[_,de]=_e({prop:te,defaultProp:n,onChange:I}),[ue,oe]=d.useState(_||m||new Date),[ee,fe]=d.useState(!1),[ae,ne]=d.useState(_ instanceof Date?se(F(_).locale(V).format(R)):""),je=()=>{re(!1),T==null||T()},we=()=>{re(!0),E==null||E()};d.useEffect(()=>{_||(B&&F(ue).isAfter(B)&&oe(B),S&&F(ue).isBefore(S)&&oe(S))},[S,B]),d.useEffect(()=>{te===null&&!ee&&ne(""),te instanceof Date&&!ee&&ne(se(F(te).locale(V).format(R)))},[te,ee,N]),d.useEffect(()=>{n instanceof Date&&ae&&!ee&&ne(se(F(_).locale(V).format(R)))},[N]);const Pe=x=>{de(x),ne(se(F(x).locale(V).format(R))),D&&je(),window.setTimeout(()=>{var he;return(he=De.current)==null?void 0:he.focus()},0)},qe=()=>{var x;de(null),q(null),ne(""),z&&we(),(x=De.current)==null||x.focus()},ve=x=>F(x,R,V).toDate(),Ne=()=>{let x=typeof _=="string"?ve(_):_;B&&F(x).isAfter(B)&&(x=B),S&&F(x).isBefore(S)&&(x=S),F(x).isValid()?(de(x),q(x),ne(se(F(x).locale(V).format(R))),oe(x)):de(be)},Ee=x=>{typeof U=="function"&&U(x),fe(!1),w&&Ne()},Oe=x=>{x.key==="Enter"&&w&&(je(),Ne())},Be=x=>{typeof v=="function"&&v(x),fe(!0)},A=x=>{we();const he=ve(x.target.value);F(he).isValid()?(de(he),q(he),ne(x.target.value),oe(he)):ne(x.target.value)};return e.jsx(Fe,{ref:ye(g,De),inputtable:w,dropdownOpened:H,setDropdownOpened:re,size:X,style:J,className:y,name:Z,inputLabel:ae,clearable:L==="date"?!1:f&&!!_&&!Y,clearButton:l,disabled:Y,type:L,inputPrefix:i,inputSuffix:C,onChange:A,onBlur:Ee,onFocus:Be,onKeyDown:Oe,onClear:qe,onDropdownClose:T,onDropdownOpen:E,...P,children:e.jsx(nt,{locale:V,month:w?ue:void 0,defaultMonth:m||(_ instanceof Date?_:new Date),value:_ instanceof Date?_:_&&F(_).toDate(),labelFormat:$,dayClassName:b,dayStyle:o,disableOutOfMonth:M,minDate:S,maxDate:B,disableDate:u,firstDayOfWeek:r,preventFocus:w,dateViewCount:k,enableHeaderLabel:j,defaultView:a,hideOutOfMonthDates:h,hideWeekdays:p,renderDay:Q,weekendDays:ce,yearLabelFormat:ie,onMonthChange:oe,onChange:Pe})})});it.displayName="DatePicker";const rt=d.forwardRef((c,g)=>{const{value:y,onChange:f,dayStyle:l,singleDate:D=!1,dateViewCount:k=1,paginateBy:b,...o}=c,[m,s]=d.useState(null),[n,a]=d.useState(null),Y=r=>{if(n instanceof Date){if(Ze(r,n)&&!D)return a(null),s(null),null;const h=[r,n];return h.sort((p,t)=>p.getTime()-t.getTime()),f(h),a(null),null}return y[0]&&Ze(r,y[0])&&!D?(a(null),s(null),f([null,null]),null):(f([r,null]),a(r),null)},u=(r,h)=>{if(n instanceof Date&&m instanceof Date){const p=[m,n];return p.sort((t,i)=>t.getTime()-i.getTime()),!h.selected&&F(r).subtract(1,"day").isBefore(p[1])&&F(r).add(1,"day").isAfter(p[0])}return!1},j=(r,h)=>{if(n instanceof Date&&m instanceof Date){const p=[m,n];return p.sort((t,i)=>t.getTime()-i.getTime()),h.selected&&F(r).isBefore(p[1])}return!1},M=(r,h)=>{if(n instanceof Date&&m instanceof Date){const p=[m,n];return p.sort((t,i)=>t.getTime()-i.getTime()),h.selected&&F(r).isAfter(p[0])}return!1};return e.jsx(At,{ref:g,dayStyle:l,value:n,range:y,dateViewCount:k,paginateBy:b||k,hideOutOfMonthDates:k>1,isDateInRange:u,isDateFirstInRange:j,isDateLastInRange:M,onDayMouseEnter:r=>s(r),onChange:r=>Y(r),...o})});rt.displayName="RangeCalendar";const et=c=>Array.isArray(c)&&c.length===2&&c.every(g=>g instanceof Date),Lt=c=>Array.isArray(c)&&c.length===2&&c[0]instanceof Date,ot=d.forwardRef((c,g)=>{const{className:y,clearable:f=!0,clearButton:l,closePickerOnChange:D=!0,dateViewCount:k=1,dayClassName:b,dayStyle:o,defaultMonth:m,defaultOpen:s=!1,defaultValue:n,defaultView:a,disabled:Y,disableDate:u,enableHeaderLabel:j,disableOutOfMonth:M,firstDayOfWeek:r="monday",hideOutOfMonthDates:h,hideWeekdays:p,inputFormat:t,inputPrefix:i,inputSuffix:C,labelFormat:w={month:"MMM",year:"YYYY"},separator:$="~",locale:G,maxDate:B,minDate:S,onChange:Z,onDropdownClose:U,onDropdownOpen:I,openPickerOnClear:v=!1,renderDay:T,singleDate:E=!1,size:z,style:Q,value:X,weekendDays:J,yearLabelFormat:L,...te}=c,{locale:ce}=Qe(),ie=G||ce,P=t||"YYYY-MM-DD",[N,V]=d.useState(s),R=d.useRef(null),[H,re]=_e({prop:X,defaultProp:n!==void 0?n:[null,null],onChange:Z}),De=ee=>{re(ee),D&&et(ee)&&(V(!1),U==null||U(),window.setTimeout(()=>{var fe;return(fe=R.current)==null?void 0:fe.focus()},0))},be=et(H),q=Lt(H),_=H!=null&&H[0]?se(F(H[0]).locale(ie).format(P)):"",de=H!=null&&H[1]?se(F(H[1]).locale(ie).format(P)):"",ue=()=>{var ee;re([null,null]),V(!0),v&&(I==null||I()),(ee=R.current)==null||ee.focus()},oe=ee=>{!ee&&q&&(H==null?void 0:H[1])===null&&ue(),V(ee)};return e.jsx(Fe,{ref:ye(g,R),dropdownOpened:N,setDropdownOpened:oe,size:z,style:Q,className:y,inputLabel:q?`${_} ${$} ${de}`:"",clearable:f&&q,clearButton:l,disabled:Y,inputPrefix:i,inputSuffix:C,onClear:ue,onDropdownClose:U,onDropdownOpen:I,...te,children:e.jsx(rt,{locale:ie,defaultMonth:be?H==null?void 0:H[0]:m,value:H,labelFormat:w,dayClassName:b,dayStyle:o,disableOutOfMonth:M,minDate:S,maxDate:B,disableDate:u,firstDayOfWeek:r,enableHeaderLabel:j,singleDate:E,dateViewCount:k,defaultView:a,hideOutOfMonthDates:h,hideWeekdays:p,renderDay:T,weekendDays:J,yearLabelFormat:L,onChange:ee=>De(ee)})})});ot.displayName="DatePickerRange";function tt(c,g){const y=d.useRef(!1);d.useEffect(()=>()=>{y.current=!1},[]),d.useEffect(()=>{if(y.current)return c();y.current=!0},g)}function We(c,g,y){return Math.min(Math.max(c,g),y)}function Yt({amLabel:c,pmLabel:g,onChange:y,nextRef:f}){return(l,D)=>{var o,m;const k=new RegExp(`(^(${c}|${g})?$)`),b=l.toLowerCase();if(b===c||b===g){y(b),D&&((o=f==null?void 0:f.current)==null||o.focus()),D&&((m=f==null?void 0:f.current)==null||m.select());return}k.test(b)&&y(b)}}function pe(c){const g=parseInt(c,10);return g>=10?g.toString():`0${g}`}function ze(c){return Math.floor(c/10)}function He({onChange:c,nextRef:g,min:y,max:f,nextMax:l}){return(D,k,b=!1)=>{var m,s;const o=parseInt(D,10);if(!Number.isNaN(o)){if(o>ze(f)||b){const n=o%10;let a,Y;o>f&&l&&n<=ze(l)?(a=pe(ze(o).toString()),Y=pe(n.toString())):a=pe(We(o,y,f).toString()),c(a,Y),k&&((m=g==null?void 0:g.current)==null||m.focus()),k&&((s=g==null?void 0:g.current)==null||s.select());return}c(o.toString())}}}function It(c,g,y,f,l,D){const k=F();let b=parseInt(c,10);const o=parseInt(g,10),m=parseInt(y,10);return Number.isNaN(b)&&(b=0),f==="12"&&(b%=12,D===l&&(b+=12)),k.hour(b).minute(Number.isNaN(o)?0:o).second(Number.isNaN(m)?0:m).millisecond(0).toDate()}function at(c,g,y,f){if(!(c instanceof Date))return{hours:"",minutes:"",seconds:"",amPm:""};let l=c.getHours();const D=l>=12;return g==="12"&&(l%=12,l===0&&(l+=12)),{hours:pe(l.toString()),minutes:pe(c.getMinutes().toString()),seconds:pe(c.getSeconds().toString()),amPm:D?f:y}}const Ae=d.forwardRef((c,g)=>{const{className:y,onFocus:f,onBlur:l,onChange:D,setValue:k,withSeparator:b=!1,max:o,min:m=0,value:s,...n}=c,[a,Y]=d.useState(0),u=d.useRef(),j=t=>{var i;typeof f=="function"&&f(t),(i=u==null?void 0:u.current)==null||i.select(),Y(0)},M=t=>{typeof l=="function"&&l(t),a===1&&typeof D=="function"&&D(t.currentTarget.value,!1)},r=t=>{var i;t.stopPropagation(),(i=u==null?void 0:u.current)==null||i.select()},h=t=>{if(t.key==="ArrowUp"){t.preventDefault();const i=pe(We(parseInt(t.currentTarget.value,10)+1,m,o).toString());s!==i&&D(i,!1)}if(t.key==="ArrowDown"){t.preventDefault();const i=pe(We(parseInt(t.currentTarget.value,10)-1,m,o).toString());s!==i&&D(i,!1)}},p=t=>{Y(a+1);const i=parseInt(t.currentTarget.value,10).toString();if(i==="0"&&a===0){k("00");return}D(i,!0,a>0)};return e.jsxs(e.Fragment,{children:[e.jsx("input",{ref:ye(u,g),type:"text",inputMode:"numeric",value:s,className:Ke("time-input-field",y),onChange:p,onClick:r,onFocus:j,onBlur:M,onKeyDown:h,...n}),b&&e.jsx("span",{children:" : "})]})});Ae.displayName="TimeInputField";const lt=d.forwardRef((c,g)=>{const{className:y,onChange:f,onFocus:l,value:D,amLabel:k,pmLabel:b,...o}=c,m=d.useRef(),s=u=>{var j;u.stopPropagation(),(j=m==null?void 0:m.current)==null||j.select()},n=u=>{(u.key==="ArrowUp"||u.key==="ArrowDown")&&(u.preventDefault(),f(D===k?b:k,!0))},a=u=>{var j;typeof l=="function"&&l(u),(j=m==null?void 0:m.current)==null||j.select()},Y=u=>{const j=u.target.value.slice(-1).toLowerCase();if(j==="p"){u.preventDefault(),f(b,!0);return}if(j==="a"){u.preventDefault(),f(k,!0);return}f(D.toString(),!0)};return e.jsx("input",{ref:ye(m,g),type:"text",value:D,className:Ke("time-input-field","am-pm-input",y),onClick:s,onFocus:a,onKeyDown:n,onChange:Y,...o})});lt.displayName="AmPmInput";const ct=d.forwardRef((c,g)=>{const{amLabel:y="am",amPmPlaceholder:f="am",className:l,clearable:D=!0,defaultValue:k,disabled:b=!1,format:o="24",field:m,form:s,id:n,invalid:a,name:Y,nextRef:u,onChange:j,pmLabel:M="pm",prefix:r,showSeconds:h=!1,size:p="md",style:t,suffix:i=e.jsx(Dt,{className:"text-lg"}),timeFieldPlaceholder:C="--",timeFieldClass:w,value:$,...G}=c,B=Pt(n),S=d.useRef(),Z=d.useRef(),U=d.useRef(),I=d.useRef(),[v,T]=d.useState(at($||k,o,y,M)),[E,z]=d.useState($||k);tt(()=>{T(at(E,o,y,M))},[E,o,y,M]),tt(()=>{($==null?void 0:$.getTime())!==(E==null?void 0:E.getTime())&&z($)},[$]);const Q=P=>{const N={...v,...P},V=It(N.hours,N.minutes,N.seconds,o,M,N.amPm);z(V),typeof j=="function"&&j(V)},X=He({onChange:(P,N)=>{Q({hours:P,minutes:N??v.minutes})},min:o==="12"?1:0,max:o==="12"?12:23,nextRef:Z,nextMax:59}),J=He({onChange:(P,N)=>{Q({minutes:P,seconds:N??v.seconds})},min:0,max:59,nextRef:h?U:o==="12"?I:u,nextMax:h?59:void 0}),L=He({onChange:P=>{Q({seconds:P})},min:0,max:59,nextRef:o==="12"?I:u}),te=Yt({amLabel:y,pmLabel:M,onChange:P=>{Q({amPm:P})},nextRef:u}),ce=()=>{var P;T({hours:"",minutes:"",seconds:"",amPm:""}),z(null),j==null||j(null),(P=S==null?void 0:S.current)==null||P.focus()},ie=D&&E?e.jsx(st,{onClick:ce}):i;return e.jsx(K,{asElement:"div",invalid:a,disabled:b,style:t,className:l,size:p,prefix:r,suffix:ie,field:m,form:s,onClick:()=>{var P;return(P=S==null?void 0:S.current)==null?void 0:P.focus()},...G,children:e.jsxs("div",{className:"time-input-wrapper",children:[e.jsx(Ae,{ref:ye(S,g),withSeparator:!0,value:v.hours,setValue:P=>T(N=>({...N,hours:P})),id:B+"-0",className:w,max:o==="12"?12:23,placeholder:C,"aria-label":"hours",disabled:b,name:Y,onChange:X}),e.jsx(Ae,{ref:Z,value:v.minutes,setValue:P=>T(N=>({...N,minutes:P})),id:B+"-1",className:w,withSeparator:h,max:59,placeholder:C,"aria-label":"minutes",disabled:b,onChange:J}),h&&e.jsx(Ae,{ref:U,value:v.seconds,setValue:P=>T(N=>({...N,seconds:P})),id:B+"-2",className:w,max:59,placeholder:C,"aria-label":"seconds",disabled:b,onChange:L}),o==="12"&&e.jsx(lt,{ref:I,value:v.amPm,placeholder:f,amLabel:y,pmLabel:M,"aria-label":"am pm",disabled:b,onChange:te})]})})});ct.displayName="TimeInput";const Vt="DD-MMM-YYYY hh:mm a",dt=d.forwardRef((c,g)=>{const{amPm:y=!0,className:f,clearable:l=!0,closePickerOnChange:D=!1,dateViewCount:k,dayClassName:b,dayStyle:o,defaultMonth:m,defaultOpen:s=!1,defaultValue:n,defaultView:a,disabled:Y=!1,disableDate:u,enableHeaderLabel:j,disableOutOfMonth:M,firstDayOfWeek:r="monday",hideOutOfMonthDates:h,hideWeekdays:p,inputFormat:t,inputPrefix:i,inputSuffix:C,inputtable:w,labelFormat:$={month:"MMM",year:"YYYY"},locale:G,maxDate:B,minDate:S,name:Z="dateTime",okButtonContent:U="OK",onBlur:I,onChange:v,onFocus:T,onDropdownClose:E,onDropdownOpen:z,openPickerOnClear:Q,renderDay:X,size:J,value:L,weekendDays:te,yearLabelFormat:ce,...ie}=c,{locale:P}=Qe(),N=G||P,V=t||Vt,[R,H]=d.useState(s),re=d.useRef(null),[De,be]=d.useState(n??null),[q,_]=_e({prop:L,defaultProp:n,onChange:v}),[de,ue]=d.useState(q||m||new Date),[oe,ee]=d.useState(!1),[fe,ae]=d.useState(q instanceof Date?se(F(q).locale(N).format(V)):""),ne=()=>{H(!1),E==null||E()},je=()=>{H(!0),z==null||z()};d.useEffect(()=>{L===null&&!oe&&ae(""),L instanceof Date&&!oe&&ae(F(L).locale(N).format(V))},[L,oe]);const we=A=>{if(q)A.setHours(q.getHours()),A.setMinutes(q.getMinutes());else{const x=new Date(Date.now());A.setHours(x.getHours()),A.setMinutes(x.getMinutes())}_(A),!L&&!D&&ae(F(A).locale(N).format(V)),D&&ae(se(F(A).locale(N).format(V))),D&&ne(),window.setTimeout(()=>{var x;return(x=re.current)==null?void 0:x.focus()},0)},Pe=()=>{var A;_(null),be(null),ae(""),Q&&je(),(A=re.current)==null||A.focus(),v==null||v(null)},qe=A=>F(A,V,N).toDate(),ve=A=>{typeof I=="function"&&I(A),ee(!1)},Ne=A=>{typeof T=="function"&&T(A),ee(!0)},Ee=A=>{je();const x=qe(A.target.value);F(x).isValid()?(_(x),be(x),D&&ae(A.target.value),ue(x)):D&&ae(A.target.value)},Oe=A=>{if(q instanceof Date&&A instanceof Date){const x=new Date(q.getFullYear(),q.getMonth(),q.getDate(),A.getHours(),A.getMinutes(),A.getSeconds(),A.getMilliseconds());_(x),!L&&!D&&ae(se(F(x).locale(N).format(V))),D&&ae(se(F(x).locale(N).format(V)))}D&&ne()},Be=()=>{ae(se(F(q).locale(N).format(V))),ne(),window.setTimeout(()=>{var A;return(A=re.current)==null?void 0:A.focus()},0),v==null||v(q)};return e.jsxs(Fe,{ref:ye(g,re),dropdownOpened:R,setDropdownOpened:H,className:f,name:Z,inputLabel:fe,clearable:l&&!!q&&!Y,disabled:Y,size:J,inputPrefix:i,inputSuffix:C,onChange:Ee,onBlur:ve,onFocus:Ne,onClear:Pe,onDropdownClose:E,onDropdownOpen:z,...ie,children:[e.jsx(nt,{locale:N,month:w?de:void 0,defaultMonth:m||(q instanceof Date?q:new Date),value:q instanceof Date?q:q&&F(q).toDate(),labelFormat:$,dayClassName:b,dayStyle:o,disableOutOfMonth:M,minDate:S,maxDate:B,disableDate:u,firstDayOfWeek:r,preventFocus:!1,dateViewCount:k,enableHeaderLabel:j,defaultView:a,hideOutOfMonthDates:h,hideWeekdays:p,renderDay:X,weekendDays:te,yearLabelFormat:ce,onMonthChange:ue,onChange:we}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(ct,{disabled:!q,value:q,format:y?"12":"24",clearable:!1,size:"sm",onChange:Oe}),e.jsx(me,{size:"sm",disabled:!q,onClick:Be,children:U})]})]})});dt.displayName="DateTimepicker";const ge=it;ge.DatePickerRange=ot;ge.DateTimepicker=dt;const $t=Me().shape({clientName:le().required("Client Name is required"),clientAddress:le().required("Client Address is required"),workDescription:le().required("Work Description is required"),dateOfEstimation:Ce().required("Estimation Date is required"),workStartDate:Ce().required("Work Start Date is required").min(Ye("dateOfEstimation"),"Work Start Date cannot be before Estimation Date"),workEndDate:Ce().required("Work End Date is required").min(Ye("workStartDate"),"Work End Date cannot be before Work Start Date"),validUntil:Ce().required("Valid Until Date is required").min(Ye("dateOfEstimation"),"Valid Until Date cannot be before Estimation Date"),paymentDueBy:Ce().required("Payment Due Date is required"),status:le().required("Status is required"),materials:Ie().of(Me().shape({subjectMaterial:le().required("Material name is required"),quantity:xe().required("Quantity is required").min(0,"Quantity must be positive"),unitPrice:xe().required("Unit price is required").min(0,"Unit price must be positive")})),labourCharges:Ie().of(Me().shape({designation:le().required("Designation is required"),quantityDays:xe().required("Days is required").min(0,"Days must be positive"),price:xe().required("Price is required").min(0,"Price must be positive")})),termsAndConditions:Ie().of(Me().shape({miscellaneous:le().required("Description is required"),quantity:xe().required("Quantity is required").min(0,"Quantity must be positive"),unitPrice:xe().required("Unit price is required").min(0,"Unit price must be positive")})),preparedByName:le().required("Prepared by is required"),checkedByName:le().required("Checked by is required"),approvedByName:le().required("Approved by is required")}),Rt=d.forwardRef((c,g)=>{const{onDiscard:y}=c,f=mt(),{id:l}=pt(),[D,k]=d.useState({clientName:"",clientAddress:"",workDescription:"",dateOfEstimation:new Date,workStartDate:new Date,workEndDate:new Date(Date.now()+7*24*60*60*1e3),validUntil:new Date(Date.now()+30*24*60*60*1e3),paymentDueBy:new Date(Date.now()+15*24*60*60*1e3),status:"Draft",materials:[{subjectMaterial:"",quantity:0,unitPrice:0,total:0}],labourCharges:[{designation:"",quantityDays:0,price:0,total:0}],termsAndConditions:[{miscellaneous:"",quantity:0,unitPrice:0,total:0}],estimatedAmount:0,preparedByName:"",checkedByName:"",approvedByName:""}),[b,o]=d.useState(!!l);d.useEffect(()=>{l&&(async()=>{try{const a=(await Je.get(`${Te}/estimation/${l}`)).data.data;k({...a,dateOfEstimation:new Date(a.dateOfEstimation),workStartDate:new Date(a.workStartDate),workEndDate:new Date(a.workEndDate),validUntil:new Date(a.validUntil),paymentDueBy:new Date(a.paymentDueBy)})}catch(n){console.error("Error fetching estimation:",n),Ve.push(e.jsx($e,{title:"Error",type:"danger",duration:2500,children:"Failed to load estimation data"}),{placement:"top-center"}),f("/estimations/list")}finally{o(!1)}})()},[l,f]);const m=async s=>{try{const n=l?`${Te}/estimation/${l}`:`${Te}/estimation`;if((await Je[l?"put":"post"](n,s)).status!==(l?200:201))throw new Error(`Failed to ${l?"update":"create"} estimation`);Ve.push(e.jsxs($e,{title:`Estimation ${l?"Updated":"Created"}`,type:"success",duration:2500,children:["Estimation ",l?"updated":"created"," successfully."]}),{placement:"top-center"}),f("/app/estimation-list")}catch(n){console.error(`Error ${l?"updating":"creating"} estimation:`,n),Ve.push(e.jsxs($e,{title:"Error",type:"danger",duration:2500,children:["Failed to ",l?"update":"create"," estimation. Please try again."]}),{placement:"top-center"})}};return b?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsx(ft,{innerRef:g,initialValues:D,validationSchema:$t,onSubmit:m,enableReinitialize:!0,children:({values:s,touched:n,errors:a,isSubmitting:Y,setFieldValue:u,handleChange:j})=>{d.useEffect(()=>{s.materials.forEach((i,C)=>{const w=parseFloat((i.quantity*i.unitPrice).toFixed(2));i.total!==w&&u(`materials[${C}].total`,w)}),s.labourCharges.forEach((i,C)=>{const w=parseFloat((i.quantityDays*i.price).toFixed(2));i.total!==w&&u(`labourCharges[${C}].total`,w)}),s.termsAndConditions.forEach((i,C)=>{const w=parseFloat((i.quantity*i.unitPrice).toFixed(2));i.total!==w&&u(`termsAndConditions[${C}].total`,w)});const r=s.materials.reduce((i,C)=>i+C.quantity*C.unitPrice,0),h=s.labourCharges.reduce((i,C)=>i+C.quantityDays*C.price,0),p=s.termsAndConditions.reduce((i,C)=>i+C.quantity*C.unitPrice,0),t=parseFloat((r+h+p).toFixed(2));if(s.estimatedAmount!==t&&u("estimatedAmount",t),s.quotationAmount!==void 0&&s.commissionAmount!==void 0){const i=parseFloat((s.quotationAmount-t-s.commissionAmount).toFixed(2));s.profit!==i&&u("profit",i)}},[s.materials,s.labourCharges,s.termsAndConditions,s.quotationAmount,s.commissionAmount]);const M=r=>{j(r);const{name:h,value:p}=r.target;u(h,parseFloat(p)||0)};return e.jsx(ht,{children:e.jsxs(gt,{children:[e.jsxs(ke,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Client & Work Details"}),e.jsx("p",{className:"mb-6",children:"Section to configure client and work information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(O,{label:"Client Name *",invalid:!!a.clientName&&n.clientName,errorMessage:a.clientName,children:e.jsx(W,{type:"text",name:"clientName",placeholder:"Client Name",component:K})}),e.jsx(O,{label:"Estimation Date *",invalid:!!a.dateOfEstimation&&n.dateOfEstimation,errorMessage:a.dateOfEstimation,children:e.jsx(W,{name:"dateOfEstimation",children:({field:r,form:h})=>e.jsx(ge,{placeholder:"Select date",value:r.value,onChange:p=>{h.setFieldValue(r.name,p)}})})})]}),e.jsx(O,{label:"Client Address *",invalid:!!a.clientAddress&&n.clientAddress,errorMessage:a.clientAddress,children:e.jsx(W,{as:"textarea",name:"clientAddress",placeholder:"Client Address",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-[#1f2937] dark:border-gray-600 dark:text-white dark:placeholder-gray-400",rows:2})}),e.jsx(O,{label:"Work Description *",invalid:!!a.workDescription&&n.workDescription,errorMessage:a.workDescription,children:e.jsx(W,{as:"textarea",name:"workDescription",placeholder:"Describe the work to be done",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-[#1f2937] dark:border-gray-600 dark:text-white dark:placeholder-gray-400",rows:3})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(O,{label:"Work Start Date *",invalid:!!a.workStartDate&&n.workStartDate,errorMessage:a.workStartDate,children:e.jsx(W,{name:"workStartDate",children:({field:r,form:h})=>e.jsx(ge,{placeholder:"Select date",value:r.value,onChange:p=>{h.setFieldValue(r.name,p)},minDate:s.dateOfEstimation})})}),e.jsx(O,{label:"Work End Date *",invalid:!!a.workEndDate&&n.workEndDate,errorMessage:a.workEndDate,children:e.jsx(W,{name:"workEndDate",children:({field:r,form:h})=>e.jsx(ge,{placeholder:"Select date",value:r.value,onChange:p=>{h.setFieldValue(r.name,p)},minDate:s.workStartDate})})}),e.jsx(O,{label:"Valid Until *",invalid:!!a.validUntil&&n.validUntil,errorMessage:a.validUntil,children:e.jsx(W,{name:"validUntil",children:({field:r,form:h})=>e.jsx(ge,{placeholder:"Select date",value:r.value,onChange:p=>{h.setFieldValue(r.name,p)},minDate:s.dateOfEstimation})})}),e.jsx(O,{label:"Payment Due By *",invalid:!!a.paymentDueBy&&n.paymentDueBy,errorMessage:a.paymentDueBy,children:e.jsx(W,{name:"paymentDueBy",children:({field:r,form:h})=>e.jsx(ge,{placeholder:"Select date",value:r.value,onChange:p=>{h.setFieldValue(r.name,p)}})})})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(O,{label:"Estimation Number",children:e.jsx(K,{readOnly:!0,value:s.estimationNumber,placeholder:"Estimation Number"})}),e.jsx(O,{label:"Status *",invalid:!!a.status&&n.status,errorMessage:a.status,children:e.jsxs(W,{as:"select",name:"status",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 dark:bg-[#1f2937] dark:border-gray-600 dark:text-white",children:[e.jsx("option",{value:"Draft",children:"Draft"}),e.jsx("option",{value:"Sent",children:"Sent"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Rejected",children:"Rejected"}),e.jsx("option",{value:"Converted",children:"Converted to Job"})]})})]})]}),e.jsxs(ke,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Materials"}),e.jsx("p",{className:"mb-6",children:"List of materials required for the project"}),e.jsx(Le,{name:"materials",children:({push:r,remove:h})=>e.jsxs("div",{className:"space-y-4",children:[s.materials.map((p,t)=>{var i,C,w,$,G,B,S,Z,U,I,v,T,E,z,Q,X,J,L;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end border-b pb-4",children:[e.jsx(O,{label:`Material ${t+1}`,invalid:!!((C=(i=a.materials)==null?void 0:i[t])!=null&&C.subjectMaterial)&&(($=(w=n.materials)==null?void 0:w[t])==null?void 0:$.subjectMaterial),errorMessage:(B=(G=a.materials)==null?void 0:G[t])==null?void 0:B.subjectMaterial,children:e.jsx(W,{type:"text",name:`materials[${t}].subjectMaterial`,placeholder:"Material name",component:K})}),e.jsx(O,{label:"Quantity",invalid:!!((Z=(S=a.materials)==null?void 0:S[t])!=null&&Z.quantity)&&((I=(U=n.materials)==null?void 0:U[t])==null?void 0:I.quantity),errorMessage:(T=(v=a.materials)==null?void 0:v[t])==null?void 0:T.quantity,children:e.jsx(W,{type:"number",name:`materials[${t}].quantity`,placeholder:"Quantity",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Unit Price",invalid:!!((z=(E=a.materials)==null?void 0:E[t])!=null&&z.unitPrice)&&((X=(Q=n.materials)==null?void 0:Q[t])==null?void 0:X.unitPrice),errorMessage:(L=(J=a.materials)==null?void 0:J[t])==null?void 0:L.unitPrice,children:e.jsx(W,{type:"number",name:`materials[${t}].unitPrice`,placeholder:"Unit price",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Total",children:e.jsx(K,{readOnly:!0,value:p.total,placeholder:"Total"})}),e.jsx("div",{className:"flex justify-end",children:s.materials.length>1&&e.jsx(me,{type:"button",size:"sm",variant:"plain",color:"red",icon:e.jsx(Re,{}),onClick:()=>h(t)})})]},t)}),e.jsx(me,{type:"button",size:"sm",variant:"twoTone",icon:e.jsx(Ue,{}),onClick:()=>r({subjectMaterial:"",quantity:0,unitPrice:0,total:0}),children:"Add Material"})]})})]}),e.jsxs(ke,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Labour Charges"}),e.jsx("p",{className:"mb-6",children:"List of labour charges for the project"}),e.jsx(Le,{name:"labourCharges",children:({push:r,remove:h})=>e.jsxs("div",{className:"space-y-4",children:[s.labourCharges.map((p,t)=>{var i,C,w,$,G,B,S,Z,U,I,v,T,E,z,Q,X,J,L;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end border-b pb-4",children:[e.jsx(O,{label:`Designation ${t+1}`,invalid:!!((C=(i=a.labourCharges)==null?void 0:i[t])!=null&&C.designation)&&(($=(w=n.labourCharges)==null?void 0:w[t])==null?void 0:$.designation),errorMessage:(B=(G=a.labourCharges)==null?void 0:G[t])==null?void 0:B.designation,children:e.jsx(W,{type:"text",name:`labourCharges[${t}].designation`,placeholder:"Designation",component:K})}),e.jsx(O,{label:"Days",invalid:!!((Z=(S=a.labourCharges)==null?void 0:S[t])!=null&&Z.quantityDays)&&((I=(U=n.labourCharges)==null?void 0:U[t])==null?void 0:I.quantityDays),errorMessage:(T=(v=a.labourCharges)==null?void 0:v[t])==null?void 0:T.quantityDays,children:e.jsx(W,{type:"number",name:`labourCharges[${t}].quantityDays`,placeholder:"Days",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Price",invalid:!!((z=(E=a.labourCharges)==null?void 0:E[t])!=null&&z.price)&&((X=(Q=n.labourCharges)==null?void 0:Q[t])==null?void 0:X.price),errorMessage:(L=(J=a.labourCharges)==null?void 0:J[t])==null?void 0:L.price,children:e.jsx(W,{type:"number",name:`labourCharges[${t}].price`,placeholder:"Price per day",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Total",children:e.jsx(K,{readOnly:!0,value:p.total,placeholder:"Total"})}),e.jsx("div",{className:"flex justify-end",children:s.labourCharges.length>1&&e.jsx(me,{type:"button",size:"sm",variant:"plain",color:"red",icon:e.jsx(Re,{}),onClick:()=>h(t)})})]},t)}),e.jsx(me,{type:"button",size:"sm",variant:"twoTone",icon:e.jsx(Ue,{}),onClick:()=>r({designation:"",quantityDays:0,price:0,total:0}),children:"Add Labour Charge"})]})})]}),e.jsxs(ke,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Terms & Conditions"}),e.jsx("p",{className:"mb-6",children:"Additional terms and conditions for the project"}),e.jsx(Le,{name:"termsAndConditions",children:({push:r,remove:h})=>e.jsxs("div",{className:"space-y-4",children:[s.termsAndConditions.map((p,t)=>{var i,C,w,$,G,B,S,Z,U,I,v,T,E,z,Q,X,J,L;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end border-b pb-4",children:[e.jsx(O,{label:`Description ${t+1}`,invalid:!!((C=(i=a.termsAndConditions)==null?void 0:i[t])!=null&&C.miscellaneous)&&(($=(w=n.termsAndConditions)==null?void 0:w[t])==null?void 0:$.miscellaneous),errorMessage:(B=(G=a.termsAndConditions)==null?void 0:G[t])==null?void 0:B.miscellaneous,children:e.jsx(W,{type:"text",name:`termsAndConditions[${t}].miscellaneous`,placeholder:"Description",component:K})}),e.jsx(O,{label:"Quantity",invalid:!!((Z=(S=a.termsAndConditions)==null?void 0:S[t])!=null&&Z.quantity)&&((I=(U=n.termsAndConditions)==null?void 0:U[t])==null?void 0:I.quantity),errorMessage:(T=(v=a.termsAndConditions)==null?void 0:v[t])==null?void 0:T.quantity,children:e.jsx(W,{type:"number",name:`termsAndConditions[${t}].quantity`,placeholder:"Quantity",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Unit Price",invalid:!!((z=(E=a.termsAndConditions)==null?void 0:E[t])!=null&&z.unitPrice)&&((X=(Q=n.termsAndConditions)==null?void 0:Q[t])==null?void 0:X.unitPrice),errorMessage:(L=(J=a.termsAndConditions)==null?void 0:J[t])==null?void 0:L.unitPrice,children:e.jsx(W,{type:"number",name:`termsAndConditions[${t}].unitPrice`,placeholder:"Unit price",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Total",children:e.jsx(K,{readOnly:!0,value:p.total,placeholder:"Total"})}),e.jsx("div",{className:"flex justify-end",children:s.termsAndConditions.length>1&&e.jsx(me,{type:"button",size:"sm",variant:"plain",color:"red",icon:e.jsx(Re,{}),onClick:()=>h(t)})})]},t)}),e.jsx(me,{type:"button",size:"sm",variant:"twoTone",icon:e.jsx(Ue,{}),onClick:()=>r({miscellaneous:"",quantity:0,unitPrice:0,total:0}),children:"Add Term"})]})})]}),e.jsxs(ke,{divider:!0,className:"mb-4",children:[e.jsx("h5",{children:"Summary"}),e.jsx("p",{className:"mb-6",children:"Final amounts and approvals"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(O,{label:"Estimated Amount",children:e.jsx(K,{readOnly:!0,name:"estimatedAmount",value:s.estimatedAmount,placeholder:"Estimated amount"})}),e.jsx(O,{label:"Quotation Amount (Optional)",children:e.jsx(W,{type:"number",name:"quotationAmount",placeholder:"Quotation amount",component:K,min:0,onChange:M})}),e.jsx(O,{label:"Commission Amount (Optional)",children:e.jsx(W,{type:"number",name:"commissionAmount",placeholder:"Commission amount",component:K,min:0,onChange:M})}),s.quotationAmount!==void 0&&s.commissionAmount!==void 0&&e.jsx(O,{label:"Profit",children:e.jsx(K,{readOnly:!0,name:"profit",value:s.profit||0,placeholder:"Profit"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(O,{label:"Prepared By *",invalid:!!a.preparedByName&&n.preparedByName,errorMessage:a.preparedByName,children:e.jsx(W,{type:"text",name:"preparedByName",placeholder:"Prepared by name",component:K})}),e.jsx(O,{label:"Checked By *",invalid:!!a.checkedByName&&n.checkedByName,errorMessage:a.checkedByName,children:e.jsx(W,{type:"text",name:"checkedByName",placeholder:"Checked by name",component:K})}),e.jsx(O,{label:"Approved By *",invalid:!!a.approvedByName&&n.approvedByName,errorMessage:a.approvedByName,children:e.jsx(W,{type:"text",name:"approvedByName",placeholder:"Approved by name",component:K})})]})]}),e.jsxs(qt,{className:"-mx-8 px-8 flex items-center justify-between py-4",stickyClass:"border-t bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{children:e.jsx(me,{size:"sm",className:"ltr:mr-3 rtl:ml-3",type:"button",onClick:y,children:"Discard"})}),e.jsx("div",{className:"md:flex items-center",children:e.jsx(me,{size:"sm",variant:"solid",loading:Y,type:"submit",children:l?"Update Estimation":"Create Estimation"})})]})]})})}})});Rt.displayName="EstimationForm";export{Rt as default};
